<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:util="http://www.springframework.org/schema/util"
       xsi:schemaLocation="
         http://www.springframework.org/schema/beans
         http://www.springframework.org/schema/beans/spring-beans.xsd
         http://www.springframework.org/schema/util
         http://www.springframework.org/schema/util/spring-util.xsd">

  <import resource="classpath:com/coremedia/cap/common/uapi-services.xml"/>
  <import resource="classpath:com/coremedia/rest/cap/cap-rest-service.xml"/>
  <import resource="classpath:com/coremedia/mimetype/mimetype-service.xml"/>
  <import resource="classpath:/com/coremedia/blueprint/base/multisite/bpbase-multisite-services.xml"/>
  <import resource="classpath:/com/coremedia/blueprint/base/links/bpbase-links-services.xml"/>
  <import resource="classpath:/com/coremedia/cap/transform/transform-services.xml"/>
  <import resource="classpath:/com/coremedia/blueprint/base/pagegrid/impl/bpbase-pagegrid-services.xml"/>

  <bean id="pictureBlobInterceptor" class="com.coremedia.rest.cap.content.interceptors.PictureBlobInterceptor">
    <property name="type" value="CMPicture"/>
    <property name="imageProperty" value="data"/>
    <property name="imageParser" ref="imageTransformerInputAdapter"/>
  </bean>

  <bean id="channelWriteInterceptor" class="com.coremedia.blueprint.base.rest.intercept.ChannelWriteInterceptor">
    <property name="type" value="CMChannel"/>
    <property name="interceptingSubtypes" value="true"/>
    <property name="propertyName" value="segment"/>
    <property name="urlPathFormattingHelper" ref="urlPathFormattingHelper"/>
  </bean>

  <bean id="siteWriteInterceptor" class="com.coremedia.blueprint.base.rest.intercept.SiteWriteInterceptor">
    <property name="type" value="CMSite"/>
    <property name="siteModel" ref="siteModel"/>
  </bean>

  <bean id="callToActionConfigurationPropertyInferrer"
        class="com.coremedia.blueprint.base.rest.propertyinferrer.CallToActionConfigurationPropertyInferrer">
    <property name="type" value="CMTeasable"/>
    <property name="applicableToSubtypes" value="true"/>
  </bean>


  <bean id="teasablePicturesPredicate" class="com.coremedia.rest.cap.validation.ContentTypePredicate">
    <property name="contentRepository" ref="contentRepository"/>
    <property name="excludeTypes" ref="teasablePicturesPredicateExcludeTypes"/>
    <property name="excludeSubtypes" ref="teasablePicturesPredicateExcludeSubtypes"/>
    <property name="includeTypes" ref="teasablePicturesPredicateIncludeTypes"/>
    <property name="includeSubtypes" ref="teasablePicturesPredicateIncludeSubtypes"/>
  </bean>

  <util:list id="teasablePicturesPredicateExcludeTypes"/>
  <util:list id="teasablePicturesPredicateExcludeSubtypes">
    <value>CMArticle</value>
  </util:list>
  <util:list id="teasablePicturesPredicateIncludeTypes"/>
  <util:list id="teasablePicturesPredicateIncludeSubtypes">
    <value>CMTeasable</value>
  </util:list>

  <bean id="imageVariantsPropertiesInferrer"
        class="com.coremedia.rest.cap.content.imagevariants.ImageVariantsPropertiesInferrer">
    <property name="transformImageService" ref="transformImageService"/>
    <property name="connection" ref="connection"/>
    <property name="structProperty" value="localSettings"/>
    <property name="dataProperty" value="data"/>
    <property name="type" value="CMPicture"/>
    <property name="applicableToSubtypes" value="true"/>
  </bean>

  <bean id="notSearchablePropertiesInferrer"
        class="com.coremedia.rest.cap.differencing.ZeroDefaultValuePropertyInferrer">
    <property name="type" value="CMTeasable"/>
    <property name="applicableToSubtypes" value="true"/>
    <property name="property" value="notSearchable"/>
  </bean>

  <bean id="hiddenPropertiesInferrer"
        class="com.coremedia.rest.cap.differencing.ZeroDefaultValuePropertyInferrer">
    <property name="type" value="CMNavigation"/>
    <property name="applicableToSubtypes" value="true"/>
    <property name="property" value="hidden"/>
  </bean>

  <bean id="hiddenInSitemapPropertiesInferrer"
        class="com.coremedia.rest.cap.differencing.ZeroDefaultValuePropertyInferrer">
    <property name="type" value="CMNavigation"/>
    <property name="applicableToSubtypes" value="true"/>
    <property name="property" value="hiddenInSitemap"/>
  </bean>

  <bean id="inHeadPropertiesInferrer"
        class="com.coremedia.rest.cap.differencing.ZeroDefaultValuePropertyInferrer">
    <property name="type" value="CMJavaScript"/>
    <property name="applicableToSubtypes" value="true"/>
    <property name="property" value="inHead"/>
  </bean>

  <bean id="ieReleavedPropertiesInferrer"
        class="com.coremedia.rest.cap.differencing.ZeroDefaultValuePropertyInferrer">
    <property name="type" value="CMAbstractCode"/>
    <property name="applicableToSubtypes" value="true"/>
    <property name="property" value="ieRevealed"/>
  </bean>

  <bean id="disableCompressPropertiesInferrer"
        class="com.coremedia.rest.cap.differencing.ZeroDefaultValuePropertyInferrer">
    <property name="type" value="CMAbstractCode"/>
    <property name="applicableToSubtypes" value="true"/>
    <property name="property" value="disableCompress"/>
  </bean>
</beans>