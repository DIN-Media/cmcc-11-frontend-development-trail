<?xml version="1.0" encoding="UTF-8"?>
<!--- 
     This is a form panel which combines several form elements to an editor for local settings to configure
     the call to action behaviour. A combination of a radio group and a string property field.
   -->
<local:CallToActionConfigurationFormBase
        xmlns:fx="http://ns.adobe.com/mxml/2009"
        xmlns:local="com.coremedia.blueprint.studio.forms.containers.*"
        xmlns:exml="http://www.jangaroo.net/exml/0.8"
        xmlns="exml:ext.config"
        xmlns:ui="exml:com.coremedia.ui.config"
        xmlns:editor="exml:com.coremedia.cms.editor.sdk.config"
        xmlns:bp-base="com.coremedia.blueprint.base.components.sites.*"
        itemId="callToActionConfigurationForm"
        title="{resourceManager.getString('com.coremedia.blueprint.studio.BlueprintDocumentTypes', 'CMTeasable_callToActionConfiguration_text')}"
        propertyNames="{[]}"
        collapsed="{config.collapsed || true}">
  <fx:Metadata>
    [ResourceBundle('com.coremedia.blueprint.studio.BlueprintDocumentTypes')]
  </fx:Metadata>
  <fx:Script><![CDATA[
    public static const xtype:String = "com.coremedia.blueprint.studio.config.callToActionConfigurationForm";

    private var config:CallToActionConfigurationForm;

    public native function CallToActionConfigurationForm(config:CallToActionConfigurationForm = null);
    ]]></fx:Script>

    <local:plugins exml:mode="append">
      <ui:BindPropertyPlugin bidirectional="true"
                             bindTo="{config.bindTo.extendBy('properties','localSettings', 'callToActionCustomText')}"
                             componentProperty="callToActionCustomText"
                             componentEvent="CTAConfigurationChanged"
                             skipIfUndefined="{true}"/>
      <ui:BindPropertyPlugin bidirectional="true"
                             bindTo="{config.bindTo.extendBy('properties','localSettings', 'callToActionDisabled')}"
                             componentProperty="callToActionDisabled"
                             componentEvent="CTAConfigurationChanged"/>
      <bp-base:SiteAwareVisibilityPlugin feature="Corporation Form Components"
                                    contentValueExpression="{config.bindTo}"/>
      <editor:PropertyFieldPlugin propertyName="callToActionConfiguration"/>
      <editor:ShowIssuesPlugin propertyName="callToActionConfiguration"
                               bindTo="{config.bindTo}"/>
    </local:plugins>
    <local:items>
      <ui:BoundRadioGroup width="auto"
                          columns="1"
                          hideLabel="true"
                          defaultValue="defaultCTA"
                          bindTo="{getModelExpression().extendBy('properties','CTAType')}">
        <ui:plugins exml:mode="append">
          <editor:BindDisablePlugin bindTo="{config.bindTo}"
                                    forceReadOnlyValueExpression="{config.forceReadOnlyValueExpression}"/>
          <editor:ShowIssuesPlugin propertyName="callToActionConfiguration"
                               bindTo="{config.bindTo}"/>
        </ui:plugins>
        <ui:items>
          <Radio itemId="noCTA"
                 inputValue="noCTA"
                 boxLabel="{resourceManager.getString('com.coremedia.blueprint.studio.BlueprintDocumentTypes', 'CMTeasable_callToActionConfiguration_no_cta_text')}"/>
          <Radio itemId="defaultCTA"
                 inputValue="defaultCTA"
                 boxLabel="{resourceManager.getString('com.coremedia.blueprint.studio.BlueprintDocumentTypes', 'CMTeasable_callToActionConfiguration_default_cta_text')}"/>
          <Radio itemId="customCTA"
                 inputValue="customCTA"
                 boxLabel="{resourceManager.getString('com.coremedia.blueprint.studio.BlueprintDocumentTypes', 'CMTeasable_callToActionConfiguration_custom_cta_text')}"/>
        </ui:items>
      </ui:BoundRadioGroup>
      <Container>
        <items>
          <ui:StatefulTextField hideLabel="true"
                     flex="1"
                     itemId="customCTAText"
                     emptyText="{resourceManager.getString('com.coremedia.blueprint.studio.BlueprintDocumentTypes', 'CMTeasable_CTAText_emptyText')}"
                     margin="0 0 0 22">
            <ui:plugins>
              <ui:BindPropertyPlugin bidirectional="true">
                <ui:bindTo>
                  <ui:ValueExpression context="{getModel().get('properties')}"
                                      expression="CTAText"/>
                </ui:bindTo>
              </ui:BindPropertyPlugin>
              <ui:ImmediateChangeEventsPlugin buffer="500"/>
              <ui:BlockEnterPlugin/>
              <editor:BindDisablePlugin bindTo="{config.bindTo}"
                                        forceReadOnlyValueExpression="{config.forceReadOnlyValueExpression}"/>
              <editor:ShowIssuesPlugin propertyName="callToActionConfiguration"
                                       bindTo="{config.bindTo}"/>
            </ui:plugins>
          </ui:StatefulTextField>
        </items>
        <layout>
          <layout_HBox align="stretch" />
        </layout>
      </Container>
    </local:items>
  
</local:CallToActionConfigurationFormBase>
